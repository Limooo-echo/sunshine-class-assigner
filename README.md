#  Sunshine Class Assigner (阳光分班系统)

这是一个基于 Python 的**阳光分班系统**，旨在实现完全公平、公正、公开的班级分配。系统通过**多维分层**和**蛇形填充（S-type）**算法，确保每个班级在“总分平均分”、“男女比例”、“城乡生源比例”以及“优生/后进生分布”上达到高度均衡。

包含配套的 `Analysis.py` 工具，用于一键生成多维度统计报表，验证分班结果的平衡性。


## Algorithm

为了实现绝对公平，我摒弃了简单的“顺序分班”或“完全随机分班”，采用了 **分层 + 蛇形 + 盲选** 的组合策略。

### Stratification：划分为三个层次
首先根据总分排名，将学生划分为三个梯队：
*   **头部 (Top N)**：每班前 10 名（确保尖子生均匀）。
*   **尾部 (Bottom N)**：每班后 10 名（确保需要帮扶的学生均匀）。
*   **腰部 (Middle)**：其余所有学生。

###  Sub-grouping：多维细分
在每个梯队内部，再次根据**性别**和**城乡**进行拆分。例如，系统会单独把“特优层里的城区男生”拿出来分配，确保每个班这类学生数量一致。

###  Snake-like Distribution：蛇形分配
这是本系统的核心。为了避免“第1班永远分到第1名”的马太效应，我们采用了 **S型往复填充**。

假设有 3 个班级（A, B, C），按成绩降序分配：

**  普通顺序分班（不公平）：**
> 1班拿第1名，1班拿第4名，1班拿第7名... **(1班优势过大)**

** 蛇形分班（S-type）：**
> **第1轮 (➡️ 正序)**：第1名->A班，第2名->B班，第3名->C班
> **第2轮 (⬅️ 逆序)**：第4名->C班，第5名->B班，第6名->A班
> **第3轮 (➡️ 正序)**：第7名->A班...

** 盲选打乱 (Random Shuffle)：**
为了进一步增加公平性，系统在每一组分配前，会**随机打乱班级序列**。
即：第一组可能是 `A->B->C`，下一组可能是 `B->C->A`。这被称为“盲选模式”，杜绝了人为控制的可能性。

---


### 验证结果 (Analysis.py)

```bash
python Analysis.py
```
*   输入上一步生成的 `xxx_分班结果.xlsx` 路径。
*   程序将输出详细的统计表格（如下所示），并生成独立的验证报告文件。

---


##  定制化修改
如果你需要调整分班策略（例如修改特优生的数量），可以修改 `Sunshine.py` 中的以下参数：

```python
# 修改前10名和后10名为“分层切片”的厚度
distributor = SunshineDistributor(CLASS_COUNT, top_n_per_class=10, bottom_n_per_class=10)
```

---


This project is open source and available under the [MIT License](LICENSE).
